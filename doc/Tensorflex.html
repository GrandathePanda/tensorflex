    <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.18.4">
    <title>Tensorflex – tensorflex v0.1.0</title>
    <link rel="stylesheet" href="dist/app-480ffdc169.css" />
    
    <script src="dist/sidebar_items-3a30d3745e.js"></script>
    
    
    
    
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

    <div class="main">
<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<button class="sidebar-button night-mode-toggle">
  <span class="icon-theme" aria-hidden="true"></span>
  <span class="sr-only">Toggle Theme</span>
</button>
<section class="sidebar">

  
  <a href="api-reference.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        tensorflex
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.1.0
      </h2>
    </div>
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="Search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    

    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


      <h1>
        <small class="visible-xs">tensorflex v0.1.0</small>
        Tensorflex
        
      </h1>

      
        <section id="moduledoc">
          <p>A simple and fast library for running Tensorflow graph models in Elixir. Tensorflex is written around the <a href="https://www.tensorflow.org/install/install_c">Tensorflow C API</a>, and allows Elixir developers to leverage Machine Learning and Deep Learning solutions in their projects.</p>
<p><strong>NOTE</strong>:</p>
<ul>
<li><p>Make sure that the C API version and Python API version (assuming you are using the Python API for first training your models) are the latest. As of July 2018, the latest version is <code class="inline">r1.9</code>.</p>
</li>
<li><p>Since Tensorflex provides Inference capability for pre-trained graph models, it is assumed you have adequate knowledge of the pre-trained models you are using (such as the input data type/dimensions, input and output operation names, etc.). Some basic understanding of the <a href="https://www.tensorflow.org/api_docs/python/">Tensorflow Python API</a> can come in very handy. </p>
</li>
<li><p>Tensorflex consists of multiple NIFs, so exercise caution while using it— providing incorrect operation names for running sessions, incorrect dimensions of tensors than the actual pre-trained graph requires, providing different tensor datatypes than the ones required by the graph can all lead to failure. While these are not easy errors to make, do ensure that you test your solution well before deployment.</p>
</li>
</ul>

        </section>
      

      
        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
          

          
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
    <div class="summary-row">
  <div class="summary-signature">
    <a href="#append_to_matrix/2">append_to_matrix(matrix, datalist)</a>
  </div>
  
    <div class="summary-synopsis"><p>Appends a single row to the back of a Tensorflex matrix</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#create_matrix/3">create_matrix(nrows, ncols, datalist)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a 2-D Tensorflex matrix from custom input specifications</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float32_tensor/1">float32_tensor(floatval)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_FLOAT</code> constant value one-dimensional tensor from the floating point value specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float32_tensor/2">float32_tensor(matrix1, matrix2)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_FLOAT</code> tensor from Tensorflex matrices containing the values and dimensions specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float32_tensor_alloc/1">float32_tensor_alloc(matrix)</a>
  </div>
  
    <div class="summary-synopsis"><p>Allocates a <code class="inline">TF_FLOAT</code> tensor of specified dimensions</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float64_tensor/1">float64_tensor(floatval)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_DOUBLE</code> constant value one-dimensional tensor from the floating point value specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float64_tensor/2">float64_tensor(matrix1, matrix2)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_DOUBLE</code> tensor from Tensorflex matrices containing the values and dimensions specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#float64_tensor_alloc/1">float64_tensor_alloc(matrix)</a>
  </div>
  
    <div class="summary-synopsis"><p>Allocates a <code class="inline">TF_DOUBLE</code> tensor of specified dimensions</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#get_graph_ops/1">get_graph_ops(graph)</a>
  </div>
  
    <div class="summary-synopsis"><p>Used for listing all the operations in a Tensorflow <code class="inline">.pb</code> graph</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#int32_tensor/1">int32_tensor(intval)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_INT32</code> constant value one-dimensional tensor from the integer value specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#int32_tensor/2">int32_tensor(matrix1, matrix2)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_INT32</code> tensor from Tensorflex matrices containing the values and dimensions specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#int32_tensor_alloc/1">int32_tensor_alloc(matrix)</a>
  </div>
  
    <div class="summary-synopsis"><p>Allocates a <code class="inline">TF_INT32</code> tensor of specified dimensions</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#load_csv_as_matrix/2">load_csv_as_matrix(filepath, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Loads high-dimensional data from a <code class="inline">CSV</code> file as a Tensorflex 2-D matrix in a super-fast manner</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#load_image_as_tensor/1">load_image_as_tensor(imagepath)</a>
  </div>
  
    <div class="summary-synopsis"><p>Loads <code class="inline">JPEG</code> images into Tensorflex directly as a <code class="inline">TF_UINT8</code> tensor of dimensions <code class="inline">image height x image width x number of color channels</code></p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#matrix_pos/3">matrix_pos(matrix, row, col)</a>
  </div>
  
    <div class="summary-synopsis"><p>Used for accessing an element of a Tensorflex matrix</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#matrix_to_lists/1">matrix_to_lists(matrix)</a>
  </div>
  
    <div class="summary-synopsis"><p>Converts a Tensorflex matrix (back) to a list of lists format</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#read_graph/1">read_graph(filepath)</a>
  </div>
  
    <div class="summary-synopsis"><p>Used for loading a Tensorflow <code class="inline">.pb</code> graph model in Tensorflex</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#run_session/5">run_session(graph, tensor1, tensor2, input_opname, output_opname)</a>
  </div>
  
    <div class="summary-synopsis"><p>Runs a Tensorflow session to generate predictions for a given graph, input data, and required input/output operations</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#size_of_matrix/1">size_of_matrix(matrix)</a>
  </div>
  
    <div class="summary-synopsis"><p>Used for obtaining the size of a Tensorflex matrix</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#string_tensor/1">string_tensor(stringval)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a <code class="inline">TF_STRING</code> constant value string tensor from the string value specified</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#tensor_datatype/1">tensor_datatype(tensor)</a>
  </div>
  
    <div class="summary-synopsis"><p>Used to get the datatype of a created tensor</p>
</div>
  
</div>

  </div>


          

        </section>
      

      

      
        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Functions
          </h1>
          <div class="detail" id="append_to_matrix/2">
  
  
  <div class="detail-header">
    <a href="#append_to_matrix/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">append_to_matrix(matrix, datalist)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Appends a single row to the back of a Tensorflex matrix.</p>
<p>Takes a Tensorflex <code class="inline">%Matrix</code> matrix as input and a single row of data (with the same number of columns as the original matrix) as a list of lists (<code class="inline">datalist</code>) to append to the original matrix.</p>
<p>Returns the extended and modified <code class="inline">%Matrix</code> struct matrix.</p>
<h2 id="append_to_matrix/2-examples" class="section-heading">
  <a href="#append_to_matrix/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; m = Tensorflex.create_matrix(2,3,[[23,23,23],[32,32,32]])
%Tensorflex.Matrix{
data: #Reference&lt;0.153563642.2042232833.193025&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; m = Tensorflex.append_to_matrix(m,[[2,2,2]])
%Tensorflex.Matrix{
data: #Reference&lt;0.153563642.2042232833.193025&gt;,
ncols: 3,
nrows: 3
}

iex(3)&gt; m = Tensorflex.append_to_matrix(m,[[3,3,3]])
%Tensorflex.Matrix{
data: #Reference&lt;0.153563642.2042232833.193025&gt;,
ncols: 3,
nrows: 4
}

iex(4)&gt; m |&gt; Tensorflex.matrix_to_lists
[[23.0, 23.0, 23.0], [32.0, 32.0, 32.0], [2.0, 2.0, 2.0], [3.0, 3.0, 3.0]]
</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(5)&gt; m = Tensorflex.append_to_matrix(m,[[2,2,2],[3,3,3]])
** (ArgumentError) data columns must be same as matrix and number of rows must be 1
(tensorflex) lib/tensorflex.ex:345: Tensorflex.append_to_matrix/2

iex(5)&gt; m = Tensorflex.append_to_matrix(m,[[2,2,2,2]])      
** (ArgumentError) data columns must be same as matrix and number of rows must be 1
(tensorflex) lib/tensorflex.ex:345: Tensorflex.append_to_matrix/2</code></pre>

  </section>
</div>
<div class="detail" id="create_matrix/3">
  
  
  <div class="detail-header">
    <a href="#create_matrix/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">create_matrix(nrows, ncols, datalist)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a 2-D Tensorflex matrix from custom input specifications.</p>
<p>Takes three input arguments: number of rows in matrix (<code class="inline">nrows</code>), number of columns in matrix (<code class="inline">ncols</code>), and a list of lists of the data that will form the matrix (<code class="inline">datalist</code>).</p>
<p>Returns a <code class="inline">%Matrix</code> Tensorflex struct type.</p>
<h2 id="create_matrix/3-examples" class="section-heading">
  <a href="#create_matrix/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<p><em>Creating a new matrix</em></p>
<pre><code class="elixir">iex(1)&gt; mat = Tensorflex.create_matrix(2,3,[[2.2,1.3,44.5],[5.5,6.1,3.333]])    %Tensorflex.Matrix{
data: #Reference&lt;0.759278808.823525378.128525&gt;,
ncols: 3,
nrows: 2
}</code></pre>
<p>All <code class="inline">%Matrix</code> Tensorflex matrices can be passed in to the other matrix inspection and manipulation functions— <a href="#matrix_pos/3"><code class="inline">matrix_pos/3</code></a>,<a href="#size_of_matrix/1"><code class="inline">size_of_matrix/1</code></a>, <a href="#matrix_to_lists/1"><code class="inline">matrix_to_lists/1</code></a>, and <a href="#append_to_matrix/2"><code class="inline">append_to_matrix/2</code></a>:</p>
<pre><code class="elixir">iex(1)&gt; mat = Tensorflex.create_matrix(4,4,[[123,431,23,1],[1,2,3,4],[5,6,7,8],[768,564,44,5]])
%Tensorflex.Matrix{
data: #Reference&lt;0.878138179.2435973124.131489&gt;,
ncols: 4,
nrows: 4
}

iex(2)&gt; mat = Tensorflex.append_to_matrix(mat, [[1,1,1,1]])
%Tensorflex.Matrix{
data: #Reference&lt;0.878138179.2435973124.131489&gt;,
ncols: 4,
nrows: 5
}

iex(3)&gt; Tensorflex.matrix_to_lists mat
[
[123.0, 431.0, 23.0, 1.0],
[1.0, 2.0, 3.0, 4.0],
[5.0, 6.0, 7.0, 8.0],
[768.0, 564.0, 44.0, 5.0],
[1.0, 1.0, 1.0, 1.0]
]

iex(4)&gt; Tensorflex.matrix_pos(mat,5,3)
1.0

iex(5)&gt; Tensorflex.size_of_matrix mat
{5, 4}</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(1)&gt; Tensorflex.create_matrix(1,2,[[1,2,3]])
** (ArgumentError) argument error
(tensorflex) Tensorflex.NIFs.create_matrix(1, 2, [[1, 2, 3]])
(tensorflex) lib/tensorflex.ex:247: Tensorflex.create_matrix/3

iex(1)&gt; Tensorflex.create_matrix(2,1,[[1,2,3]])
** (ArgumentError) argument error
(tensorflex) Tensorflex.NIFs.create_matrix(2, 1, [[1, 2, 3]])
(tensorflex) lib/tensorflex.ex:247: Tensorflex.create_matrix/3

iex(1)&gt; Tensorflex.create_matrix(2,3,[[1.1,23,3.4], []])
** (ArgumentError) argument error
  (tensorflex) Tensorflex.NIFs.create_matrix(2, 3, [[1.1, 23, 3.4], []])
  (tensorflex) lib/tensorflex.ex:247: Tensorflex.create_matrix/3
  
iex(1)&gt; Tensorflex.create_matrix(1,2,[[]])              
** (ArgumentError) data provided cannot be an empty list
(tensorflex) lib/tensorflex.ex:243: Tensorflex.create_matrix/3

iex(1)&gt; Tensorflex.create_matrix(-1,2,[[3,4]])
** (FunctionClauseError) no function clause matching in Tensorflex.create_matrix/3    </code></pre>

  </section>
</div>
<div class="detail" id="float32_tensor/1">
  
  
  <div class="detail-header">
    <a href="#float32_tensor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float32_tensor(floatval)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_FLOAT</code> constant value one-dimensional tensor from the floating point value specified.</p>
<p>Takes in a float value as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="float32_tensor/1-examples" class="section-heading">
  <a href="#float32_tensor/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.float32_tensor 123.123
{:ok,
%Tensorflex.Tensor{
datatype: :tf_float,
tensor: #Reference&lt;0.2011963375.1804468228.236110&gt;
}}
</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(2)&gt; {:ok, tensor} = Tensorflex.float32_tensor &quot;123.123&quot;
** (FunctionClauseError) no function clause matching in Tensorflex.float32_tensor/1 

iex(2)&gt; {:ok, tensor} = Tensorflex.float32_tensor 123      
** (FunctionClauseError) no function clause matching in Tensorflex.float32_tensor/1</code></pre>

  </section>
</div>
<div class="detail" id="float32_tensor/2">
  
  
  <div class="detail-header">
    <a href="#float32_tensor/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float32_tensor(matrix1, matrix2)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_FLOAT</code> tensor from Tensorflex matrices containing the values and dimensions specified.</p>
<p>Takes two arguments: a <code class="inline">%Matrix</code> matrix (<code class="inline">matrix1</code>) containing the values the tensor should have and another <code class="inline">%Matrix</code> matrix (<code class="inline">matrix2</code>) containing the dimensions of the required tensor.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="float32_tensor/2-examples" class="section-heading">
  <a href="#float32_tensor/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<pre><code class="elixir">iex(1)&gt; vals = Tensorflex.create_matrix(2,3,[[12.0,45.2,2.11],[36.7,8.09,9.81]])
%Tensorflex.Matrix{
data: #Reference&lt;0.1251941183.3671982081.254268&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; dims = Tensorflex.create_matrix(1,2,[[2,3]])
%Tensorflex.Matrix{
data: #Reference&lt;0.1251941183.3671982081.254723&gt;,
ncols: 2,
nrows: 1
}
  
iex(3)&gt; {:ok, tensor} = Tensorflex.float32_tensor vals,dims
{:ok,
%Tensorflex.Tensor{
datatype: :tf_float,
tensor: #Reference&lt;0.1251941183.3671982081.255228&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="float32_tensor_alloc/1">
  
  
  <div class="detail-header">
    <a href="#float32_tensor_alloc/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float32_tensor_alloc(matrix)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Allocates a <code class="inline">TF_FLOAT</code> tensor of specified dimensions.</p>
<p>This function is generally used to allocate output tensors that do not hold any value data yet, but <em>will</em> after the session is run for Inference. Output tensors of the required dimensions are allocated and then passed to the <a href="#run_session/5"><code class="inline">run_session/5</code></a> function to hold the output values generated as predictions.</p>
<p>Takes a Tensorflex <code class="inline">%Matrix</code> struct matrix as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding the potential tensor data and type.</p>
<h2 id="float32_tensor_alloc/1-examples" class="section-heading">
  <a href="#float32_tensor_alloc/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<p>As an example, we can allocate a <code class="inline">float32</code> output tensor that will be a vector of 250 values (<code class="inline">1x250</code> matrix). Therefore, after the session is run, the output will be a <code class="inline">float</code> vector containing 250 values:</p>
<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.create_matrix(1,2,[[1,250]]) |&gt; Tensorflex.float32_tensor_alloc
{:ok,
%Tensorflex.Tensor{
datatype: :tf_float,
tensor: #Reference&lt;0.961157994.2087059457.19014&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="float64_tensor/1">
  
  
  <div class="detail-header">
    <a href="#float64_tensor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float64_tensor(floatval)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_DOUBLE</code> constant value one-dimensional tensor from the floating point value specified.</p>
<p>Takes in a float value as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="float64_tensor/1-examples" class="section-heading">
  <a href="#float64_tensor/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.float64_tensor 123.123
{:ok,
%Tensorflex.Tensor{
datatype: :tf_double,
tensor: #Reference&lt;0.2778616536.4219338753.155412&gt;
}}
</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(2)&gt; {:ok, tensor} = Tensorflex.float64_tensor &quot;123.123&quot;
** (FunctionClauseError) no function clause matching in Tensorflex.float64_tensor/1

iex(2)&gt; {:ok, tensor} = Tensorflex.float64_tensor 123      
** (FunctionClauseError) no function clause matching in Tensorflex.float64_tensor/1</code></pre>

  </section>
</div>
<div class="detail" id="float64_tensor/2">
  
  
  <div class="detail-header">
    <a href="#float64_tensor/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float64_tensor(matrix1, matrix2)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_DOUBLE</code> tensor from Tensorflex matrices containing the values and dimensions specified.</p>
<p>Takes two arguments: a <code class="inline">%Matrix</code> matrix (<code class="inline">matrix1</code>) containing the values the tensor should have and another <code class="inline">%Matrix</code> matrix (<code class="inline">matrix2</code>) containing the dimensions of the required tensor.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="float64_tensor/2-examples" class="section-heading">
  <a href="#float64_tensor/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<pre><code class="elixir">iex(1)&gt; vals = Tensorflex.create_matrix(2,3,[[12.0,45.2,2.11],[36.7,8.09,9.81]])
%Tensorflex.Matrix{
data: #Reference&lt;0.1251941183.3671982081.254268&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; dims = Tensorflex.create_matrix(1,2,[[2,3]])
%Tensorflex.Matrix{
data: #Reference&lt;0.1251941183.3671982081.254723&gt;,
ncols: 2,
nrows: 1
}

iex(3)&gt; {:ok, tensor} = Tensorflex.float64_tensor vals,dims
{:ok,
%Tensorflex.Tensor{
datatype: :tf_double,
tensor: #Reference&lt;0.1251941183.3671982081.255216&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="float64_tensor_alloc/1">
  
  
  <div class="detail-header">
    <a href="#float64_tensor_alloc/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">float64_tensor_alloc(matrix)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Allocates a <code class="inline">TF_DOUBLE</code> tensor of specified dimensions.</p>
<p>  This function is generally used to allocate output tensors that do not hold any value data yet, but <em>will</em> after the session is run for Inference. Output tensors of the required dimensions are allocated and then passed to the <a href="#run_session/5"><code class="inline">run_session/5</code></a> function to hold the output values generated as predictions.</p>
<p>  Takes a Tensorflex <code class="inline">%Matrix</code> struct matrix as input.</p>
<p>  Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding the potential tensor data and type.</p>
<h2 id="float64_tensor_alloc/1-examples" class="section-heading">
  <a href="#float64_tensor_alloc/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<p>As an example, we can allocate a <code class="inline">float64</code> output tensor that will be a vector of 250 values (<code class="inline">1x250</code> matrix). Therefore, after the session is run, the output will be a <code class="inline">double</code> vector containing 250 values:</p>
<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.create_matrix(1,2,[[1,250]]) |&gt; Tensorflex.float64_tensor_alloc
{:ok,
%Tensorflex.Tensor{
datatype: :tf_double,
tensor: #Reference&lt;0.961157994.2087059457.19025&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="get_graph_ops/1">
  
  
  <div class="detail-header">
    <a href="#get_graph_ops/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">get_graph_ops(graph)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Used for listing all the operations in a Tensorflow <code class="inline">.pb</code> graph.</p>
<p>Reads in a Tensorflex <code class="inline">%Graph</code> struct obtained from <a href="#read_graph/1"><code class="inline">read_graph/1</code></a>.</p>
<p>Returns a list of all the operation names (as strings) that populate the graph model.</p>
<h2 id="get_graph_ops/1-examples" class="section-heading">
  <a href="#get_graph_ops/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<ul>
<li><em>Google Inception CNN Model</em> (<a href="http://download.tensorflow.org/models/image/imagenet/inception-2015-12-05.tgz">source</a>)
</li>
</ul>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph &quot;classify_image_graph_def.pb&quot;
2018-07-23 15:31:35.949345: W tensorflow/core/framework/op_def_util.cc:346] Op BatchNormWithGlobalNormalization is deprecated. It will cease to work in GraphDef version 9. Use tf.nn.batch_normalization().
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.3018278404.759824385.5268&gt;,
name: &quot;classify_image_graph_def.pb&quot;
}}

iex(2)&gt; Tensorflex.get_graph_ops graph
[&quot;DecodeJpeg/contents&quot;, &quot;DecodeJpeg&quot;, &quot;Cast&quot;, &quot;ExpandDims/dim&quot;, &quot;ExpandDims&quot;,
&quot;ResizeBilinear/size&quot;, &quot;ResizeBilinear&quot;, &quot;Sub/y&quot;, &quot;Sub&quot;, &quot;Mul/y&quot;, &quot;Mul&quot;,
&quot;conv/conv2d_params&quot;, &quot;conv/Conv2D&quot;, &quot;conv/batchnorm/beta&quot;,
&quot;conv/batchnorm/gamma&quot;, &quot;conv/batchnorm/moving_mean&quot;,
&quot;conv/batchnorm/moving_variance&quot;, &quot;conv/batchnorm&quot;, &quot;conv/CheckNumerics&quot;,
&quot;conv/control_dependency&quot;, &quot;conv&quot;, &quot;conv_1/conv2d_params&quot;, &quot;conv_1/Conv2D&quot;,
&quot;conv_1/batchnorm/beta&quot;, &quot;conv_1/batchnorm/gamma&quot;,
&quot;conv_1/batchnorm/moving_mean&quot;, &quot;conv_1/batchnorm/moving_variance&quot;,
&quot;conv_1/batchnorm&quot;, &quot;conv_1/CheckNumerics&quot;, &quot;conv_1/control_dependency&quot;,
&quot;conv_1&quot;, &quot;conv_2/conv2d_params&quot;, &quot;conv_2/Conv2D&quot;, &quot;conv_2/batchnorm/beta&quot;,
&quot;conv_2/batchnorm/gamma&quot;, &quot;conv_2/batchnorm/moving_mean&quot;,
&quot;conv_2/batchnorm/moving_variance&quot;, &quot;conv_2/batchnorm&quot;, &quot;conv_2/CheckNumerics&quot;,
&quot;conv_2/control_dependency&quot;, &quot;conv_2&quot;, &quot;pool/CheckNumerics&quot;,
&quot;pool/control_dependency&quot;, &quot;pool&quot;, &quot;conv_3/conv2d_params&quot;, &quot;conv_3/Conv2D&quot;,
&quot;conv_3/batchnorm/beta&quot;, &quot;conv_3/batchnorm/gamma&quot;,
&quot;conv_3/batchnorm/moving_mean&quot;, &quot;conv_3/batchnorm/moving_variance&quot;, ...]</code></pre>
<ul>
<li><em>Iris Dataset MLP Model</em> (<a href="http://www.anshumanc.ml/gsoc/2018/06/14/gsoc/">source</a>)
</li>
</ul>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph &quot;graphdef_iris.pb&quot;
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.4109712726.1847984130.24506&gt;,
name: &quot;graphdef_iris.pb&quot;
}}

iex(2)&gt; Tensorflex.get_graph_ops graph
[&quot;input&quot;, &quot;weights1&quot;, &quot;weights1/read&quot;, &quot;biases1&quot;, &quot;biases1/read&quot;, &quot;weights2&quot;, &quot;weights2/read&quot;, &quot;biases2&quot;, &quot;biases2/read&quot;, &quot;MatMul&quot;, &quot;Add&quot;, &quot;Relu&quot;, &quot;MatMul_1&quot;, &quot;Add_1&quot;, &quot;output&quot;]
</code></pre>
<ul>
<li><em>Toy Computational Graph Model</em> (<a href="https://github.com/anshuman23/tensorflex/tree/master/examples/toy-example">source</a>)
</li>
</ul>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph &quot;graphdef_toy.pb&quot;
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.1274892327.1580335105.235135&gt;,
name: &quot;graphdef_toy.pb&quot;
}}

iex(2)&gt; Tensorflex.get_graph_ops graph
[&quot;input&quot;, &quot;weights&quot;, &quot;weights/read&quot;, &quot;biases&quot;, &quot;biases/read&quot;, &quot;MatMul&quot;, &quot;add&quot;, &quot;output&quot;]</code></pre>
<ul>
<li><em>RNN LSTM Sentiment Analysis Model</em> (<a href="https://github.com/anshuman23/tensorflex/pull/25">source</a>)
</li>
</ul>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph &quot;frozen_model_lstm.pb&quot;
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.713975820.1050542081.11558&gt;,
name: &quot;frozen_model_lstm.pb&quot;
}}

iex(2)&gt; Tensorflex.get_graph_ops graph
[&quot;Placeholder_1&quot;, &quot;embedding_lookup/params_0&quot;, &quot;embedding_lookup&quot;,
&quot;transpose/perm&quot;, &quot;transpose&quot;, &quot;rnn/Shape&quot;, &quot;rnn/strided_slice/stack&quot;,
&quot;rnn/strided_slice/stack_1&quot;, &quot;rnn/strided_slice/stack_2&quot;, &quot;rnn/strided_slice&quot;,
&quot;rnn/stack/1&quot;, &quot;rnn/stack&quot;, &quot;rnn/zeros/Const&quot;, &quot;rnn/zeros&quot;, &quot;rnn/stack_1/1&quot;,
&quot;rnn/stack_1&quot;, &quot;rnn/zeros_1/Const&quot;, &quot;rnn/zeros_1&quot;, &quot;rnn/Shape_1&quot;,
&quot;rnn/strided_slice_2/stack&quot;, &quot;rnn/strided_slice_2/stack_1&quot;,
&quot;rnn/strided_slice_2/stack_2&quot;, &quot;rnn/strided_slice_2&quot;, &quot;rnn/time&quot;,
&quot;rnn/TensorArray&quot;, &quot;rnn/TensorArray_1&quot;, &quot;rnn/TensorArrayUnstack/Shape&quot;,
&quot;rnn/TensorArrayUnstack/strided_slice/stack&quot;,
&quot;rnn/TensorArrayUnstack/strided_slice/stack_1&quot;,
&quot;rnn/TensorArrayUnstack/strided_slice/stack_2&quot;,
&quot;rnn/TensorArrayUnstack/strided_slice&quot;, &quot;rnn/TensorArrayUnstack/range/start&quot;,
&quot;rnn/TensorArrayUnstack/range/delta&quot;, &quot;rnn/TensorArrayUnstack/range&quot;,
&quot;rnn/TensorArrayUnstack/TensorArrayScatter/TensorArrayScatterV3&quot;,
&quot;rnn/while/Enter&quot;, &quot;rnn/while/Enter_1&quot;, &quot;rnn/while/Enter_2&quot;,
&quot;rnn/while/Enter_3&quot;, &quot;rnn/while/Merge&quot;, &quot;rnn/while/Merge_1&quot;,
&quot;rnn/while/Merge_2&quot;, &quot;rnn/while/Merge_3&quot;, &quot;rnn/while/Less/Enter&quot;,
&quot;rnn/while/Less&quot;, &quot;rnn/while/LoopCond&quot;, &quot;rnn/while/Switch&quot;,
&quot;rnn/while/Switch_1&quot;, &quot;rnn/while/Switch_2&quot;, &quot;rnn/while/Switch_3&quot;, ...]</code></pre>

  </section>
</div>
<div class="detail" id="int32_tensor/1">
  
  
  <div class="detail-header">
    <a href="#int32_tensor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">int32_tensor(intval)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_INT32</code> constant value one-dimensional tensor from the integer value specified.</p>
<p>Takes in an integer value as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="int32_tensor/1-examples" class="section-heading">
  <a href="#int32_tensor/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.int32_tensor 123
{:ok,
%Tensorflex.Tensor{
datatype: :tf_int32,
tensor: #Reference&lt;0.1927663658.3415343105.162588&gt;
}}</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(2)&gt; {:ok, tensor} = Tensorflex.int32_tensor 123.123
** (FunctionClauseError) no function clause matching in Tensorflex.int32_tensor/1 

iex(2)&gt; {:ok, tensor} = Tensorflex.int32_tensor &quot;123.123&quot;
** (FunctionClauseError) no function clause matching in Tensorflex.int32_tensor/1  
</code></pre>

  </section>
</div>
<div class="detail" id="int32_tensor/2">
  
  
  <div class="detail-header">
    <a href="#int32_tensor/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">int32_tensor(matrix1, matrix2)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_INT32</code> tensor from Tensorflex matrices containing the values and dimensions specified.</p>
<p>Takes two arguments: a <code class="inline">%Matrix</code> matrix (<code class="inline">matrix1</code>) containing the values the tensor should have and another <code class="inline">%Matrix</code> matrix (<code class="inline">matrix2</code>) containing the dimensions of the required tensor.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<p><strong>NOTE</strong>: In case floating point values are passed in the values matrix (<code class="inline">matrix1</code>) as arguments for this function, the tensor will still be created and all the float values will be typecast to integers. </p>
<h2 id="int32_tensor/2-examples" class="section-heading">
  <a href="#int32_tensor/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<pre><code class="elixir">iex(1)&gt; vals = Tensorflex.create_matrix(2,3,[[123,45,333],[2,2,899]]) 
%Tensorflex.Matrix{
data: #Reference&lt;0.1256144000.2868510721.170449&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; dims = Tensorflex.create_matrix(1,2,[[2,3]])
%Tensorflex.Matrix{
data: #Reference&lt;0.1256144000.2868510721.170894&gt;,
ncols: 2,
nrows: 1
}

iex(3)&gt; {:ok, tensor} = Tensorflex.int32_tensor vals,dims
{:ok,
%Tensorflex.Tensor{
datatype: :tf_int32,
tensor: #Reference&lt;0.1256144000.2868510721.171357&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="int32_tensor_alloc/1">
  
  
  <div class="detail-header">
    <a href="#int32_tensor_alloc/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">int32_tensor_alloc(matrix)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Allocates a <code class="inline">TF_INT32</code> tensor of specified dimensions.</p>
<p>This function is generally used to allocate output tensors that do not hold any value data yet, but <em>will</em> after the session is run for Inference. Output tensors of the required dimensions are allocated and then passed to the <a href="#run_session/5"><code class="inline">run_session/5</code></a> function to hold the output values generated as predictions.</p>
<p>Takes a Tensorflex <code class="inline">%Matrix</code> struct matrix as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding the potential tensor data and type.</p>
<h2 id="int32_tensor_alloc/1-examples" class="section-heading">
  <a href="#int32_tensor_alloc/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<p>As an example, we can allocate an <code class="inline">int32</code> output tensor that will be a vector of 250 values (<code class="inline">1x250</code> matrix). Therefore, after the session is run, the output will be an <code class="inline">integer</code> vector containing 250 values:</p>
<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.create_matrix(1,2,[[1,250]]) |&gt; Tensorflex.int32_tensor_alloc
{:ok,
%Tensorflex.Tensor{
datatype: :tf_int32,
tensor: #Reference&lt;0.961157994.2087059457.18950&gt;
}}
</code></pre>

  </section>
</div>
<div class="detail" id="load_csv_as_matrix/2">
  
  
    <span id="load_csv_as_matrix/1"></span>
  
  <div class="detail-header">
    <a href="#load_csv_as_matrix/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">load_csv_as_matrix(filepath, opts \\ [])</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Loads high-dimensional data from a <code class="inline">CSV</code> file as a Tensorflex 2-D matrix in a super-fast manner.</p>
<p>The <a href="#load_csv_as_matrix/2"><code class="inline">load_csv_as_matrix/2</code></a> function is very fast— when compared with the Python based <code class="inline">pandas</code> library for data science and analysis’ function <code class="inline">read_csv</code> on the <code class="inline">test.csv</code> file from MNIST Kaggle data (<a href="https://www.kaggle.com/c/digit-recognizer/data">source</a>), the following execution times were obtained:</p>
<ul>
<li><code class="inline">read_csv</code>: <code class="inline">2.549233</code> seconds
</li>
<li><a href="#load_csv_as_matrix/2"><code class="inline">load_csv_as_matrix/2</code></a>: <code class="inline">1.711494</code> seconds
</li>
</ul>
<p>This function takes in 2 arguments: a path to a valid CSV file (<code class="inline">filepath</code>) and other optional arguments <code class="inline">opts</code>. These include whether or not a header needs to be discarded in the CSV, and what the delimiter type is. These are specified by passing in an atom <code class="inline">:true</code> or <code class="inline">:false</code> to the <code class="inline">header:</code> key, and setting a string value for the <code class="inline">delimiter:</code> key. By default, the header is considered to be present (<code class="inline">:true</code>) and the delimiter is set to <code class="inline">,</code>.</p>
<p>Returns a <code class="inline">%Matrix</code> Tensorflex struct type.</p>
<h2 id="load_csv_as_matrix/2-examples" class="section-heading">
  <a href="#load_csv_as_matrix/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<p>We first exemplify the working with the <code class="inline">test.csv</code> file which belongs to the MNIST Kaggle CSV data (<a href="https://www.kaggle.com/c/digit-recognizer/data">source</a>), which contains <code class="inline">28000</code> rows and <code class="inline">784</code> columns (without the header). It is comma delimited and also contains a header. From the <code class="inline">test.csv</code> file, we also create a custom file withou the header present which we refer to as <code class="inline">test_without_header.csv</code> in the examples below:</p>
<pre><code class="elixir">iex(1)&gt; mat = Tensorflex.load_csv_as_matrix(&quot;test.csv&quot;)
%Tensorflex.Matrix{
data: #Reference&lt;0.4024686574.590479361.258459&gt;,
ncols: 784,
nrows: 28000
}

iex(2)&gt; Tensorflex.matrix_pos mat, 5,97
80.0

iex(3)&gt; Tensorflex.matrix_pos mat, 5,96
13.0</code></pre>
<p>On a visual inspection of the very large <code class="inline">test.csv</code> file, one can see that the values in these particular positions are correct. Now we show usage for the same file but without header, <code class="inline">test_without_header.csv</code>:</p>
<pre><code class="elixir">iex(1)&gt; no_header = Tensorflex.load_csv_as_matrix(&quot;test/test_without_header.csv&quot;, header: :false)    
%Tensorflex.Matrix{
data: #Reference&lt;0.4024686574.590479364.257078&gt;,
ncols: 784,
nrows: 28000
}

iex(2)&gt; Tensorflex.matrix_pos no_header,5,97
80.0

iex(3)&gt; Tensorflex.matrix_pos no_header,5,96
13.0</code></pre>
<p>Next we see the delimiter functionalities. First, assuming we have two simple <code class="inline">CSV</code> files, <code class="inline">sample1.csv</code> and <code class="inline">sample2.csv</code></p>
<p><em>sample1.csv</em>:</p>
<pre><code class="elixir">1,2,3,4,5
6,7,8,9,10
11,12,13,14,15</code></pre>
<p><em>sample2.csv</em>:</p>
<pre><code class="elixir">col1-col2-col3-col4
1-2-3-4
5-6-7-8
9-10-11-12</code></pre>
<p>The examples are as follows:</p>
<pre><code class="elixir">iex(1)&gt; m1 = Tensorflex.load_csv_as_matrix(&quot;sample1.csv&quot;, header: :false) 
%Tensorflex.Matrix{
data: #Reference&lt;0.3878093040.3013214209.247502&gt;,
ncols: 5,
nrows: 3
}

iex(2)&gt; Tensorflex.matrix_to_lists m1
[
[1.0, 2.0, 3.0, 4.0, 5.0],
[6.0, 7.0, 8.0, 9.0, 10.0],
[11.0, 12.0, 13.0, 14.0, 15.0]
]

iex(3)&gt; m2 = Tensorflex.load_csv_as_matrix(&quot;sample2.csv&quot;, header: :true, delimiter: &quot;-&quot;)
%Tensorflex.Matrix{
data: #Reference&lt;0.4024686574.590479361.258952&gt;,
ncols: 4,
nrows: 3
}

iex(4)&gt; Tensorflex.matrix_to_lists m2
[[1.0, 2.0, 3.0, 4.0], [5.0, 6.0, 7.0, 8.0], [9.0, 10.0, 11.0, 12.0]]</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(1)&gt; not_working = Tensorflex.load_csv_as_matrix(&quot;test.csv&quot;, header: :no_header, delimiter: &quot;,&quot;)
** (ArgumentError) header indicator atom must be either :true or :false 
(tensorflex) lib/tensorflex.ex:122: Tensorflex.load_csv_as_matrix/2</code></pre>

  </section>
</div>
<div class="detail" id="load_image_as_tensor/1">
  
  
  <div class="detail-header">
    <a href="#load_image_as_tensor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">load_image_as_tensor(imagepath)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Loads <code class="inline">JPEG</code> images into Tensorflex directly as a <code class="inline">TF_UINT8</code> tensor of dimensions <code class="inline">image height x image width x number of color channels</code>.</p>
<p>This function is very useful if you wish to do image classification using Convolutional Neural Networks, or other Deep Learning Models. One of the most widely adopted and robust image classification models is the <a href="http://download.tensorflow.org/models/image/imagenet/inception-2015-12-05.tgz">Inception</a> model by Google. It makes classifications on images from over a 1000 classes with highly accurate results. The <a href="#load_image_as_tensor/1"><code class="inline">load_image_as_tensor/1</code></a> function is an essential component for the prediction pipeline of the Inception model (and for other similar image classification models) to work in Tensorflex.</p>
<p>Reads in the path to a <code class="inline">JPEG</code> image file (<code class="inline">.jpg</code> or <code class="inline">.jpeg</code>).</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding the tensor data and type. Here the created Tensor is a <code class="inline">uint8</code> tensor (<code class="inline">TF_UINT8</code>).</p>
<p><strong>NOTE</strong>: For now, only 3 channel RGB <code class="inline">JPEG</code> color images can be passed as arguments. Support for grayscale images and other image formats such as <code class="inline">PNG</code> will be added in the future. </p>
<h2 id="load_image_as_tensor/1-examples" class="section-heading">
  <a href="#load_image_as_tensor/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<p>To exemplify the working of the <a href="#load_image_as_tensor/1"><code class="inline">load_image_as_tensor/1</code></a> function we will cover the entire prediction pipeline for the Inception model. However, this makes use of many other Tensorflex functions such as <a href="#run_session/5"><code class="inline">run_session/5</code></a> and the other tensor functions so it would be advisable to go through them first. Also, the Inception model can be downloaded <a href="http://download.tensorflow.org/models/image/imagenet/inception-2015-12-05.tgz">here</a>. We will be making use of the <code class="inline">cropped_panda.jpg</code> image file that comes along with the model to test out the model in Tensorflex.</p>
<p>First the graph is loaded:</p>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph(&quot;classify_image_graph_def.pb&quot;)
2018-07-25 14:20:29.079139: W tensorflow/core/framework/op_def_util.cc:346] Op BatchNormWithGlobalNormalization is deprecated. It will cease to work in GraphDef version 9. Use tf.nn.batch_normalization().
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.542869014.389152771.105680&gt;,
name: &quot;classify_image_graph_def.pb&quot;
}}</code></pre>
<p>Then we load the image as a <code class="inline">uint8</code> tensor:</p>
<pre><code class="elixir">iex(2)&gt; {:ok, input_tensor} = Tensorflex.load_image_as_tensor(&quot;cropped_panda.jpg&quot;)
{:ok,
%Tensorflex.Tensor{
datatype: :tf_uint8,
tensor: #Reference&lt;0.1203951739.122552322.52747&gt;
}}</code></pre>
<p>Then we create the output tensor which will hold out output vector values. For the Inception model, the output is received as a <code class="inline">1008x1 float32</code> tensor, as there are 1008 classes in the model:</p>
<pre><code class="elixir">iex(3)&gt; {:ok, output_tensor} = Tensorflex.create_matrix(1,2,[[1008,1]]) |&gt; Tensorflex.float32_tensor_alloc
{:ok,
%Tensorflex.Tensor{
datatype: :tf_float,
tensor: #Reference&lt;0.1203951739.122552322.52794&gt;
}}</code></pre>
<p>Next, we obtain the results by running the session:</p>
<pre><code class="elixir">iex(4)&gt; results = Tensorflex.run_session(graph, input_tensor, output_tensor, &quot;DecodeJpeg&quot;, &quot;softmax&quot;)
2018-07-25 14:33:40.992813: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
[
[1.059142014128156e-4, 2.8240500250831246e-4, 8.30648496048525e-5,
1.2982363114133477e-4, 7.32232874725014e-5, 8.014426566660404e-5,
6.63459359202534e-5, 0.003170756157487631, 7.931600703159347e-5,
3.707312498590909e-5, 3.0997329304227605e-5, 1.4232713147066534e-4,
1.0381334868725389e-4, 1.1057958181481808e-4, 1.4321311027742922e-4,
1.203602587338537e-4, 1.3130248407833278e-4, 5.850398520124145e-5,
2.641105093061924e-4, 3.1629020668333396e-5, 3.906813799403608e-5,
2.8646905775531195e-5, 2.2863158665131778e-4, 1.2222197256051004e-4,
5.956588938715868e-5, 5.421260357252322e-5, 5.996063555357978e-5,
4.867801326327026e-4, 1.1005574924638495e-4, 2.3433618480339646e-4,
1.3062104699201882e-4, 1.317620772169903e-4, 9.388553007738665e-5,
7.076268957462162e-5, 4.281177825760096e-5, 1.6863139171618968e-4,
9.093972039408982e-5, 2.611844101920724e-4, 2.7584232157096267e-4,
5.157176201464608e-5, 2.144951868103817e-4, 1.3628098531626165e-4,
8.007588621694595e-5, 1.7929042223840952e-4, 2.2831936075817794e-4,
6.216531619429588e-5, 3.736453436431475e-5, 6.782123091397807e-5,
1.1538144462974742e-4, ...]
]
</code></pre>
<p>Finally, we need to find which class has the maximum probability and identify it’s label. Since <code class="inline">results</code> is a List of Lists, it’s better to read in the flattened list. Then we need to find the index of the element in the new list which as the maximum value. Therefore:</p>
<pre><code class="elixir">iex(5)&gt; max_prob = List.flatten(results) |&gt; Enum.max
0.8849328756332397

iex(6)&gt; Enum.find_index(results |&gt; List.flatten, fn(x) -&gt; x == max_prob end)
169</code></pre>
<p>We can thus see that the class with the maximum probability predicted (<code class="inline">0.8849328756332397</code>) for the image is <code class="inline">169</code>. We will now find what the <code class="inline">169</code> label corresponds to. For this we can look back into the unzipped Inception folder, where there is a file called <code class="inline">imagenet_2012_challenge_label_map_proto.pbtxt</code>. On opening this file, we can find the string class identifier for the <code class="inline">169</code> class index. This is <code class="inline">n02510455</code> and is present on Line 1556 in the file. Finally, we need to match this string identifier to a set of identification labels by referring to the file <code class="inline">imagenet_synset_to_human_label_map.txt</code> file. Here we can see that corresponding to the string class <code class="inline">n02510455</code> the human labels are <code class="inline">giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca</code> (Line 3691 in the file). Thus, we have correctly identified the animal in the image as a panda using Tensorflex.</p>

  </section>
</div>
<div class="detail" id="matrix_pos/3">
  
  
  <div class="detail-header">
    <a href="#matrix_pos/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">matrix_pos(matrix, row, col)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Used for accessing an element of a Tensorflex matrix. </p>
<p>Takes in three input arguments: a Tensorflex <code class="inline">%Matrix</code> struct matrix, and the row (<code class="inline">row</code>) and column (<code class="inline">col</code>) values of the required element in the matrix. Both <code class="inline">row</code> and <code class="inline">col</code> here are <strong>NOT</strong> zero indexed.</p>
<p>Returns the value as float.</p>
<h2 id="matrix_pos/3-examples" class="section-heading">
  <a href="#matrix_pos/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; mat = Tensorflex.create_matrix(2,3,[[2.2,1.3,44.5],[5.5,6.1,3.333]])
%Tensorflex.Matrix{
data: #Reference&lt;0.759278808.823525378.128525&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; Tensorflex.matrix_pos(mat,2,1)
5.5

iex(3)&gt; Tensorflex.matrix_pos(mat,1,3)
44.5
</code></pre>

  </section>
</div>
<div class="detail" id="matrix_to_lists/1">
  
  
  <div class="detail-header">
    <a href="#matrix_to_lists/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">matrix_to_lists(matrix)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Converts a Tensorflex matrix (back) to a list of lists format.</p>
<p>Takes a Tensorflex <code class="inline">%Matrix</code> struct matrix as input.</p>
<p>Returns a list of lists representing the data stored in the matrix.</p>
<p><strong>NOTE</strong>: If the matrix contains very high dimensional data, typically obtained from a function like <a href="#load_csv_as_matrix/2"><code class="inline">load_csv_as_matrix/2</code></a>, then it is not recommended to convert the matrix back to a list of lists format due to a possibility of memory errors.</p>
<h2 id="matrix_to_lists/1-examples" class="section-heading">
  <a href="#matrix_to_lists/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; Tensorflex.create_matrix(2,3,[[23,23,23],[32,32,32]]) |&gt; Tensorflex.matrix_to_lists
[[23.0, 23.0, 23.0], [32.0, 32.0, 32.0]]</code></pre>

  </section>
</div>
<div class="detail" id="read_graph/1">
  
  
  <div class="detail-header">
    <a href="#read_graph/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">read_graph(filepath)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Used for loading a Tensorflow <code class="inline">.pb</code> graph model in Tensorflex.</p>
<p>Reads in a pre-trained Tensorflow protobuf (<code class="inline">.pb</code>) Graph model binary file.</p>
<p>Returns a tuple <code class="inline">{:ok, %Graph}</code>. </p>
<p><code class="inline">%Graph</code> is an internal Tensorflex struct which holds the name of the graph file and the binary definition data that is read in via the <code class="inline">.pb</code> file. </p>
<h2 id="read_graph/1-examples" class="section-heading">
  <a href="#read_graph/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples:
</h2>

<p><em>Reading in a graph</em></p>
<p>As an example, we can try reading in the <a href="http://download.tensorflow.org/models/image/imagenet/inception-2015-12-05.tgz">Inception</a> convolutional neural network based image classification graph model by Google. The graph file is named <code class="inline">classify_image_graph_def.pb</code>:</p>
<pre><code class="elixir">iex(1)&gt; {:ok, graph} = Tensorflex.read_graph &quot;classify_image_graph_def.pb&quot;
2018-07-23 15:31:35.949345: W tensorflow/core/framework/op_def_util.cc:346] Op BatchNormWithGlobalNormalization is deprecated. It will cease to work in GraphDef version 9. Use tf.nn.batch_normalization().
{:ok,
%Tensorflex.Graph{
def: #Reference&lt;0.3018278404.759824385.5268&gt;,
name: &quot;classify_image_graph_def.pb&quot;
}}</code></pre>
<p>Generally to check that the loaded graph model is correct and contains computational operations, the <a href="#get_graph_ops/1"><code class="inline">get_graph_ops/1</code></a> function is useful:</p>
<pre><code class="elixir">iex(2)&gt; Tensorflex.get_graph_ops graph
[&quot;DecodeJpeg/contents&quot;, &quot;DecodeJpeg&quot;, &quot;Cast&quot;, &quot;ExpandDims/dim&quot;, &quot;ExpandDims&quot;,
&quot;ResizeBilinear/size&quot;, &quot;ResizeBilinear&quot;, &quot;Sub/y&quot;, &quot;Sub&quot;, &quot;Mul/y&quot;, &quot;Mul&quot;,
&quot;conv/conv2d_params&quot;, &quot;conv/Conv2D&quot;, &quot;conv/batchnorm/beta&quot;,
&quot;conv/batchnorm/gamma&quot;, &quot;conv/batchnorm/moving_mean&quot;,
&quot;conv/batchnorm/moving_variance&quot;, &quot;conv/batchnorm&quot;, &quot;conv/CheckNumerics&quot;,
&quot;conv/control_dependency&quot;, &quot;conv&quot;, &quot;conv_1/conv2d_params&quot;, &quot;conv_1/Conv2D&quot;,
&quot;conv_1/batchnorm/beta&quot;, &quot;conv_1/batchnorm/gamma&quot;,
&quot;conv_1/batchnorm/moving_mean&quot;, &quot;conv_1/batchnorm/moving_variance&quot;,
&quot;conv_1/batchnorm&quot;, &quot;conv_1/CheckNumerics&quot;, &quot;conv_1/control_dependency&quot;,
&quot;conv_1&quot;, &quot;conv_2/conv2d_params&quot;, &quot;conv_2/Conv2D&quot;, &quot;conv_2/batchnorm/beta&quot;,
&quot;conv_2/batchnorm/gamma&quot;, &quot;conv_2/batchnorm/moving_mean&quot;,
&quot;conv_2/batchnorm/moving_variance&quot;, &quot;conv_2/batchnorm&quot;, &quot;conv_2/CheckNumerics&quot;,
&quot;conv_2/control_dependency&quot;, &quot;conv_2&quot;, &quot;pool/CheckNumerics&quot;,
&quot;pool/control_dependency&quot;, &quot;pool&quot;, &quot;conv_3/conv2d_params&quot;, &quot;conv_3/Conv2D&quot;,
&quot;conv_3/batchnorm/beta&quot;, &quot;conv_3/batchnorm/gamma&quot;,
&quot;conv_3/batchnorm/moving_mean&quot;, &quot;conv_3/batchnorm/moving_variance&quot;, ...]
</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(3)&gt; {:ok, graph} = Tensorflex.read_graph &quot;Makefile&quot;
** (ArgumentError) file is not a protobuf .pb file
(tensorflex) lib/tensorflex.ex:27: Tensorflex.read_graph/1

iex(3)&gt; {:ok, graph} = Tensorflex.read_graph &quot;Makefile.pb&quot;
** (ArgumentError) graph definition file does not exist
(tensorflex) lib/tensorflex.ex:23: Tensorflex.read_graph/1
</code></pre>

  </section>
</div>
<div class="detail" id="run_session/5">
  
  
  <div class="detail-header">
    <a href="#run_session/5" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">run_session(graph, tensor1, tensor2, input_opname, output_opname)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Runs a Tensorflow session to generate predictions for a given graph, input data, and required input/output operations.</p>
<p>This function is the final step of the Inference (prediction) pipeline and generates output for a given set of input data, a pre-trained graph model, and the specified input and output operations of the graph.</p>
<p>Takes in five arguments: a pre-trained Tensorflow graph <code class="inline">.pb</code> model read in from the <a href="#read_graph/1"><code class="inline">read_graph/1</code></a> function (<code class="inline">graph</code>), an input tensor with the dimensions and data required for the input operation of the graph to run (<code class="inline">tensor1</code>), an output tensor allocated with the right dimensions (<code class="inline">tensor2</code>), the name of the input operation of the graph that needs where the input data is fed (<code class="inline">input_opname</code>), and the output operation name in the graph where the outputs are obtained (<code class="inline">output_opname</code>). The input tensor is generally created from the matrices manually or using the <a href="#load_csv_as_matrix/2"><code class="inline">load_csv_as_matrix/2</code></a> function, and then passed through to one of the tensor creation functions. For image classification the <a href="#load_image_as_tensor/1"><code class="inline">load_image_as_tensor/1</code></a> can also be used to create the input tensor from an image. The output tensor is created using the tensor allocation functions (generally containing <code class="inline">alloc</code> at the end of the function name).  </p>
<p>Returns a List of Lists (similar to the <a href="#matrix_to_lists/1"><code class="inline">matrix_to_lists/1</code></a> function) containing the generated predictions as per the output tensor dimensions.</p>
<h2 id="run_session/5-examples" class="section-heading">
  <a href="#run_session/5-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<ul>
<li><p>A blog post <a href="http://www.anshumanc.ml/gsoc/2018/06/14/gsoc/">here</a> covers generating predictions and running sessions using an MLP model on the Iris Dataset</p>
</li>
<li><p>Generating predictions from the Inception model by Google is covered in the <a href="#load_image_as_tensor/1"><code class="inline">load_image_as_tensor/1</code></a> function examples.</p>
</li>
<li><p>Working with an RNN-LSTM example for sentiment analysis is covered <a href="https://github.com/anshuman23/tensorflex/pull/25">here</a>.  </p>
</li>
</ul>

  </section>
</div>
<div class="detail" id="size_of_matrix/1">
  
  
  <div class="detail-header">
    <a href="#size_of_matrix/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">size_of_matrix(matrix)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Used for obtaining the size of a Tensorflex matrix.</p>
<p>Takes a Tensorflex <code class="inline">%Matrix</code> struct matrix as input.</p>
<p>Returns a tuple <code class="inline">{nrows, ncols}</code> where <code class="inline">nrows</code> represents the number of rows of the matrix and <code class="inline">ncols</code> represents the number of columns of the matrix.</p>
<h2 id="size_of_matrix/1-examples" class="section-heading">
  <a href="#size_of_matrix/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; mat = Tensorflex.create_matrix(2,3,[[2.2,1.3,44.5],[5.5,6.1,3.333]])
%Tensorflex.Matrix{
data: #Reference&lt;0.759278808.823525378.128525&gt;,
ncols: 3,
nrows: 2
}

iex(2)&gt; Tensorflex.size_of_matrix mat
{2, 3}</code></pre>

  </section>
</div>
<div class="detail" id="string_tensor/1">
  
  
  <div class="detail-header">
    <a href="#string_tensor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">string_tensor(stringval)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates a <code class="inline">TF_STRING</code> constant value string tensor from the string value specified.</p>
<p>Takes in a string value as input.</p>
<p>Returns a tuple <code class="inline">{:ok, %Tensor}</code> where <code class="inline">%Tensor</code> represents an internal Tensorflex struct type that is used for holding tensor data and type.</p>
<h2 id="string_tensor/1-examples" class="section-heading">
  <a href="#string_tensor/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.string_tensor &quot;123.123&quot;
{:ok,
%Tensorflex.Tensor{
datatype: :tf_string,
tensor: #Reference&lt;0.2069282048.194904065.41126&gt;
}}
</code></pre>
<p><em>Incorrect usage will <code class="inline">raise</code></em>:</p>
<pre><code class="elixir">iex(2)&gt; {:ok, tensor} = Tensorflex.string_tensor 123.123  
** (FunctionClauseError) no function clause matching in Tensorflex.string_tensor/1 

iex(2)&gt; {:ok, tensor} = Tensorflex.string_tensor 123    
** (FunctionClauseError) no function clause matching in Tensorflex.string_tensor/1</code></pre>

  </section>
</div>
<div class="detail" id="tensor_datatype/1">
  
  
  <div class="detail-header">
    <a href="#tensor_datatype/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">tensor_datatype(tensor)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Used to get the datatype of a created tensor.</p>
<p>Takes in a <code class="inline">%Tensor</code> struct tensor as input.</p>
<p>Returns a tuple <code class="inline">{:ok, datatype}</code> where <code class="inline">datatype</code> is an atom representing the list of Tensorflow <code class="inline">TF_DataType</code> tensor datatypes. Click <a href="https://github.com/anshuman23/tensorflex/blob/master/c_src/c_api.h#L98-L122">here</a> to view a list of all possible datatypes.</p>
<h2 id="tensor_datatype/1-examples" class="section-heading">
  <a href="#tensor_datatype/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="elixir">iex(1)&gt; {:ok, tensor} = Tensorflex.string_tensor &quot;example&quot;
{:ok,
%Tensorflex.Tensor{
datatype: :tf_string,
tensor: #Reference&lt;0.4132928949.2894987267.194583&gt;
}}

iex(2)&gt; Tensorflex.tensor_datatype tensor
{:ok, :tf_string}</code></pre>

  </section>
</div>

        </section>
      

      
          <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.18.4),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-9bd040e5e5.js"></script>
  
  
  
  
  </body>
</html>

